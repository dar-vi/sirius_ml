# Решение к кейсу по CV для отбора на смену Тинькофф в Сириусе по машинному обучению
_Дарья Ващенко_  

_Сразу хочу сказать, что это мой первый опыт в сфере обработки изображений (раньше работала с анализом текстовых датасетов). Но я всё равно хочу попробовать себя в этом направлении, а что получится - увидим в этом отчёте._

## Инструкция
1) Датасет, который я использовала прикреплен отдельным файлом в репозитории, а также на всякий случай я оставлю ссылку на датасет в гугл диске https://drive.google.com/file/d/1KUFYWr1T8IpBsjdQqXeTaEbwdmMW5APV/view?usp=sharing  
2) Код написан в Google Colab, ссылка на него https://colab.research.google.com/drive/1uwm9bxRdU8TbLakF2fVdnP7BXvlwY8Qt?usp=sharing  
3) Если возникнут какие-то проблемы с запуском кода или чем-нибудь ещё - пожалуйста, напишите мне в телеграм https://t.me/dar_vi

## Образ и предпочтения инопланетян
Мне кажется, что розовые инопланетяне смотрелись бы довольно необычно. Планета бы их была похожа на Землю, а сами инопланетяне хоть и отличались внешне от людей, но потребности имели бы такие же.
<img src="https://github.com/dar-vi/sirius_ml_Vashchenko/blob/main/alien/planet.jpg"  width="1000" height="200">   
Так как инопланетяне смогли выйти на контакт с нашей цивилизацией, можно сделать вывод, что их раса довольно развита, а соответственно их может привлечь более современный и утонченный интерьер. Наверняка им понравятся минимализм в интерьере. Также важно избежать старых и несовременных бытовых устройств в отеле (то есть нужны современные телевизоры и т.п.). Вряд ли инопланетянам понравится устаревшая мебель. Но при этом в отеле должно быть что-то, что является уникальным для нас (чтобы придать изюминку нахождению другой цивилизации на нашей планете). Думаю, что картины идеально подойдут на эту роль. Также не стоит забывать о наличии панорамных окон в комнате - ведь гости точно захотят посмотреть на космос и поискать свою планету среди миллиарда звезд. Для построения изображения с образом инопланетянина я воспользуюсь StabbleDiffusion. Вот так мог бы выглядеть иноплянетянин в отеле, который ему бы понравился:  

<img src="https://github.com/dar-vi/sirius_ml_Vashchenko/blob/main/alien/alien.png" width="300" height="300"> <img src="https://github.com/dar-vi/sirius_ml_Vashchenko/blob/main/alien/room.jpg" width="300" height="300"> <img src="https://github.com/dar-vi/sirius_ml_Vashchenko/blob/main/alien/alien_3.png" width="300" height="300">  

  А вот так могли бы выглядеть инопланетяне, решающие задачу для отбора на смену от Тинькофф в Сириусе:  
  <img src="https://github.com/dar-vi/sirius_ml_Vashchenko/blob/main/alien/alien_4.png" width="400" height="400">   <img src="https://github.com/dar-vi/sirius_ml_Vashchenko/blob/main/alien/alien_2.jpg" width="500" height="400">  
  
## Задача по изучению датасета 
1. `Тема и её проблематика`  
   1.1 Что такое image captioning?  
   Дословный перевод - подписи к изображениям. Эта задача представляет собой кодирование входного изображения в промежуточное представление информации на нем, а затем декодирование его в последовательность описательного текста. Данная задача включает себя и компьютерное зрение (CV), и обработку естественного языка. В настоящее время это направление активно используется в нейронных сетях.
   
   1.2 Почему над этим работают?  
   Есть множество применений для данной задачи. Например, автоматическая индексация и поиск изображений: image captioning позволяет создавать текстовые описания для большого количества изображений, что упрощает процесс индексации и поиска. Например, на основе сгенерированных описаний можно выполнять поиск по ключевым словам или использовать их для классификации и сортировки изображений. Также эта задача является важной составляющей в разработке автономных систем, таких как роботы или автомобили с функцией распознавания изображений. Сгенерированные описания могут помочь системам лучше понимать окружающую среду и принимать соответствующие решения. Также это может помочь людям с ограниченными возможностями. Сгенерированные описания могут помочь им лучше понимать содержание изображений, например, при просмотре фотографий или чтении книг.
   
   1.3 Как формулируется задача?  
    Наша задача состоит в том, чтобы обработать изображения отелей в приведенном датасете, добавить к ним описания(тэги), кластеризовать датасет по тэгам, а в конце попробовать изменить изображения при помощи диффузионной модели.
   
3. `Аннотация датасета`   
   Я использовала датасет под названием "test_set.csv". Файл с ним я прикреплю отдельно в репозитории. На всякий случай еще раз прикреплю ссылку на мой код в Google Colab https://colab.research.google.com/drive/1uwm9bxRdU8TbLakF2fVdnP7BXvlwY8Qt?usp=sharing  
   
   2.1 Что представлено на изображениях?  
   Представлены фотографии номеров в отелях, причем часть фотографий - основные комнаты отеля, а часть - ванные комнаты. Фотографии отличаюются друг от друга их размером/качеством. Также сами отели тоже имеют ремонт в разных стилях (где-то, например, более современный дизайн, а где-то устаревший). 
   
   2.2 Сколько объектов в датасете? Сколько уникальных классов? Сбалансирован ли датасет?  
   В исходном датасете 5 столбцов и 16171 строк. У каждого отеля, как правило, по несколько фотографий (в основном по четыре). Количество уникальных отелей (то есть вообще сколько всего разных отелей) - 4718. Можно сказать, что датасет частично сбалансирован т.к. у каждого отеля в нем чаще всего по 4 фотографии. Но есть и исключения (например, отели с двумя фотографиями)
   
   2.3 Какие параметры у изображений? Какой размер у фотографий?  
   Размеры у фотографий могут сильно отличаться. Например, есть фотографии с размером (в байтах) примерно 40.000, а есть и с размером больше 150.000. Соответственно, можно сделать вывод, что есть отели и с не очень современным ремонтом, и с хорошим ремонтом (Такой вывод можно сделать исходя из того, что современные отели вряд ли бы фотографировали на плохую камеру).

## Обогащение датасета описаниями

